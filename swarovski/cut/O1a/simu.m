function simu(tag,kind)%% SIMU  Various simulations%%          simu(p)%          simu(p,'all')%          simu(p,'vx')%          simu(p,'sode1')  % 1 graph (vx)%          simu(p,'sode4')  % 4 graphs (ux(1), ux(2), vx(1), vx(2))%%          simu 3.2a        % Abbildung 3.2a (Transienten-Analyse - max(uy))%          simu 3.3a        % Abbildung 3.3 (uy)%          simu 3.3b        % Abbildung 3.3 (vx)%          simu 70er        % 70-er Kugel%   switch tag      case '3.2a'         Simu_3_2a;      case '3.3a'         Simu_3_3a;      case '3.3b'         Simu_3_3b;      otherwise         p = tag;         if (nargin < 2)            kind = p.kind         end         switch kind            case 'vx'               SimuVx(p)            case 'sode1'               SimuSode1(p)            case 'sode4'               SimuSode4(p)            otherwise               SimuAll(p);         end   endend   %=============================================================================% Plotting%=============================================================================function hdl = Title(str)   hdl = title(str);   set(hdl,'fontsize',12),endfunction hdl = Xlabel(str)   hdl = xlabel(str);   set(hdl,'fontsize',12),endfunction hdl = Ylabel(str)   hdl = ylabel(str);   set(hdl,'fontsize',12),endfunction Plot(t,x,colors,labels)   if (nargin < 3)      colors = {'r','b','g','c','m','y','k'}   end      if (nargin >= 4)      clf   end      [m,n] = size(x);   for (i=1:m)      col = colors{1+rem(i-1,length(colors))};      hdl = plot(t,x(i,:),col);      hold on;      set(hdl,'linewidth',1);   end   set(gca,'fontsize',25)      if (nargin >= 4)      hdl = legend(labels,'location','northeast');      set(hdl,'fontsize',12);   endend   %=============================================================================% micron display%=============================================================================function [x,unit] = Micron(x)  % discriminate whether micron display   micron = all(all(abs(x([1,2],:))<=0.001));   if (micron)      fac = 1e6;  unit = '[um]';   else       fac = 1e3;  unit = '[mm]';   end    x(1,:) = fac*x(1,:);   x(2,:) = fac*x(2,:);end%=============================================================================% Simu All%=============================================================================   function SimuAll(p)   [x,t] = heun(p);   [x,unit] = Micron(x);      clf   subplot(221);   Plot(t,x(1,:),{'r'});   hdl = Ylabel(['Amplitude ux ',unit]);   set(gca,'fontsize',18)   set(hdl,'fontsize',12),      subplot(222);   Plot(t,x(2,:),{'m'});   hdl = Ylabel(['Amplitude uy',unit]);   set(gca,'fontsize',18)   set(hdl,'fontsize',12),   hdl = Title(sprintf('Fn = %g',p.Fn));   set(hdl,'fontsize',12),   subplot(223);   Plot(t,x(3,:),{'b'});   hdl = Ylabel('Geschwindigkeit vx [m/s]');   hold on;   set(gca,'fontsize',18)   set(hdl,'fontsize',12),   hdl=Title(sprintf('v = %g m/s',p.v));   set(hdl,'fontsize',12),   plot(t,0*t+p.v,'r')   subplot(224);   Plot(t,x(4,:),{'g'});   hdl = Ylabel('Geschwindigkeit vy [m/s]');   set(gca,'fontsize',18)   set(hdl,'fontsize',12),   hdl = Title(sprintf('mu = %g',p.mu));   set(hdl,'fontsize',12),end   %=============================================================================% Sode Simu - 4 Graphs%=============================================================================function SimuSode4(p)   [x1,t,x2] = sode(p);   [x1,unit1] = Micron(x1);   [x2,unit2] = Micron(x2);      clf   subplot(221);   Plot(t,x1(1,:),{'r'});   hdl = Ylabel(['Amplitude ux(1) ',unit1]);   set(gca,'fontsize',18)   set(hdl,'fontsize',12),      subplot(222);   Plot(t,x2(1,:),{'r'});   hdl = Ylabel(['Amplitude ux(2) ',unit2]);   set(gca,'fontsize',18)   set(hdl,'fontsize',12),   hdl = Title(sprintf('Fn = %g',p.Fn));   set(hdl,'fontsize',12),   subplot(223);   Plot(t,x1(3,:),{'b'});   hdl = Ylabel('Geschwindigkeit vx(1) [m/s]');   hold on;   set(gca,'fontsize',18)   set(hdl,'fontsize',12),   hdl=Title(sprintf('v = %g m/s',p.v));   set(hdl,'fontsize',12),   %plot(t,0*t+p.v,'r')   subplot(224);   Plot(t,x2(3,:),{'b'});   hdl = Ylabel('Geschwindigkeit vx(2) [m/s]');   set(gca,'fontsize',18)   set(hdl,'fontsize',12),   hdl = Title(sprintf('mu = %g',p.mu));   set(hdl,'fontsize',12),end   %=============================================================================% Sode Simu - 1 Graph (vx)%=============================================================================function SimuSode1(p)   [x,t] = sode(p,p.tmax,p.dt);   clf   Plot(t*1000,x(3,:),{'b'});   if (max(abs(x(3,:))) > p.v)      hold on      plot(t*1000,0*t+p.v,'r');      end      Title(p.info)   Xlabel('Zeit t [ms]')   Ylabel(['Geschwindigkeit ux [m/s]'])end   %=============================================================================% Simu vx%=============================================================================function SimuVx(p)   [x,t] = heun(p);   clf   Plot(t*1000,x(3,:),{'b'});   hold on   plot(t*1000,0*t+p.v,'r');         Title(p.info)   Xlabel('Zeit t [ms]')   Ylabel('Geschwindigkeit ux [m/s]')end   %=============================================================================% Abbildung 3.2a%=============================================================================function Simu_3_2a   p = hoga(1);       p.c = 0.5;  p.c1 = p.c;  p.c2 = p.c;   p.dt = 0.0005;   clf   [xm,par] = maxmag(p,8,'mu',0:0.1:2);      Plot(par,xm(1:2,:),{'r','m'});   Title('Transiente Untersuchung: v = 1, c1 = c2 = c = 0.5')   Xlabel('mu')   Ylabel('max. Amplitude ux,uy')end     %=============================================================================% Abbildung 3.3a%=============================================================================function Simu_3_3a   p = hoga(1);       p.mu = 0.75;   [x,t] = heun(p);   uy(1,:) = x(2,:);      p.mu = 0.8;   [x,t] = heun(p);   uy(2,:) = x(2,:);   p.mu = 0.85;   [x,t] = heun(p);   uy(3,:) = x(2,:);   labels = {'Reibbeiwert mu = 0.75','Reibbeiwert mu = 0.80',...             'Reibbeiwert mu = 0.85'};      Plot(t,uy,{'k','r','b'},labels);   Title('Transiente Untersuchung: v = 1, c1 = c2 = c = 1.0')   Xlabel('Zeit t')   Ylabel('Amplitude uy')end     %=============================================================================% Abbildung 3.3b%=============================================================================function Simu_3_3b   p = hoga(1);       p.mu = 0.75;   [x,t] = heun(p);   vx(1,:) = x(3,:);      p.mu = 0.8;   [x,t] = heun(p);   vx(2,:) = x(3,:);   p.mu = 0.85;   [x,t] = heun(p);   vx(3,:) = x(3,:);   labels = {'Reibbeiwert mu = 0.75','Reibbeiwert mu = 0.80',...             'Reibbeiwert mu = 0.85'};      Plot(t,vx,{'k','r','b'},labels);   Title('Transiente Untersuchung: v = 1, c1 = c2 = c = 1.0')   Xlabel('Zeit t')   Ylabel('Amplitude vx')end     
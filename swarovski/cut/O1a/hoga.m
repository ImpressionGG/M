function f = hoga(x,p,t)%% HOGA Hoffmann/Gaul Modell - Simulationsbeispiel%%      Usage:%           [x,t] = heun(hoga,p)%           [x,t] = heun(hoga,hoga(1))%           [x,t] = heun(hoga(1))%%           x0 = hoga         % get initial state%           p = hoga(n)       % get default parameters%           f = hoga(x,p,t)   % get derivative (t so far not used)%%      Differential equations:%%              :             .                                            .%      [m  0] [ux]   [c1 0] [ux]   [kx+k/2 -k/2] [ux]   [-mu*ky*uy*sign(1-ux/v)]%      [    ]*[: ] + [    ] [. ] + [           ]*[  ] = [                      ] %      [0  m] [uy]   [0 c2] [uy]   [-k/2 ky+k/2] [uy]   [         -Fn          ]%%       See also: CUT, SHELL, SIMU%   function p = p0   %   % P0   Default parameter set (see Tabelle 3.1)   %      p.info = 'HOGA default parameter set (see Table 3.1)';            p.kx = 100;   % [N/m]  Steifigkeit kx      p.ky = 100;   % [N/m]  Steifigkeit ky      p.k  = 100;   % [N/m]  Koppelsteifigkeit k      p.c1 = 1;     % [kg/s] Dämpfungsparameter c1 (1-1.2)      p.c2 = 1;     % [kg/s] Dämpfungsparameter c2 (1-1.2)      p.m  = 0.1;   % [kg]   Masse      p.Fn = 10;    % [N]    Normalkraft      p.mu = 1;     % [1]    Reibkoeffizient (0-2)      p.v  = 5;     % [m/s]  Bandgeschwindigkeit (1-5)            p.ux0 = 0;    % [m]    Anfangsauslenkung      p.uy0 = 0.01; % [m]    Anfangsauslenkung      p.vx0 = 0;    % [m/s]  Anfangsgeschwindigkeit      p.vy0 = 0;    % [m/s]  Anfangsgeschwindigkeit            p.tmax = 1;      p.dt = 0.001;      p.kind = 'all'   end   function p = p1   %   % P1   Parameter set for simulation example (see Abbildung 3.3)   %      p.info = 'HOGA demo 1: v = 1, mu = 0.75 (see Figure 3.3)';      p.kx = 100;   % [N/m]  Steifigkeit kx      p.ky = 100;   % [N/m]  Steifigkeit ky      p.k  = 100;   % [N/m]  Koppelsteifigkeit k      p.c1 = 1;     % [kg/s] Dämpfungsparameter c1 (1-1.2)      p.c2 = 1;     % [kg/s] Dämpfungsparameter c2 (1-1.2)      p.m  = 0.1;   % [kg]   Masse      p.Fn = 10;    % [N]    Normalkraft      p.Sn =  0;    % [N]    Normalkraft-Schwankung      p.fn =  5;    % [N]    Normalkraft-Schwankungs-Frequenz      p.mu = 0.75;  % [1]    Reibkoeffizient (0-2)                   !!!      p.v  = 1;     % [m/s]  Bandgeschwindigkeit (1-5)            p.ux0 = 0;    % [m]    Anfangsauslenkung      p.uy0 = 0.01; % [m]    Anfangsauslenkung      p.vx0 = 0;    % [m/s]  Anfangsgeschwindigkeit      p.vy0 = 0;    % [m/s]  Anfangsgeschwindigkeit         p.tmax = 5;      p.dt = 0.001;      p.kind = 'all'   end         function p = p2   %   % P2   Parameter set for 60er Kugel   %      p.info = 'HOGA demo 2: v = 1, mu = 0.8, c = 5 (60er Kugel)';      p.kx = 3.5e7; % [N/m]  Steifigkeit kx      p.ky = 2.2e9; % [N/m]  Steifigkeit ky      p.k  = 1e8;   % [N/m]  Koppelsteifigkeit k      p.c1 = 5;     % [kg/s] Dämpfungsparameter c1 (1-1.2)      p.c2 = 5;     % [kg/s] Dämpfungsparameter c2 (1-1.2)      p.m  = 1;     % [kg]   Masse      p.Fn = 1000;  % [N]    Normalkraft      p.Sn =  0;    % [N]    Normalkraft-Schwankung      p.fn =  5;    % [N]    Normalkraft-Schwankungs-Frequenz      p.mu = 0.8;   % [1]    Reibkoeffizient (0-2)                   !!!      p.v  = 5;     % [m/s]  Bandgeschwindigkeit (1-5)            p.ux0 = 0;    % [m]    Anfangsauslenkung      p.uy0 = 0;    % [m]    Anfangsauslenkung      p.vx0 = 0;    % [m/s]  Anfangsgeschwindigkeit      p.vy0 = 0;    % [m/s]  Anfangsgeschwindigkeit         p.tmax = 0.011;      p.dt = 1e-6;      p.kind = 'vx'   end   function p = p3   %   % P3   Parameter set for 60er Kugel   %      p.info = 'HOGA demo 3: v = 1, mu = 0.8, c = 1 (60er Kugel)';      p.kx = 3.5e7; % [N/m]  Steifigkeit kx      p.ky = 2.2e9; % [N/m]  Steifigkeit ky      p.k  = 1e8;   % [N/m]  Koppelsteifigkeit k      p.c1 = 0;     % [kg/s] Dämpfungsparameter c1 (1-1.2)      p.c2 = 0;     % [kg/s] Dämpfungsparameter c2 (1-1.2)      p.m  = 1;     % [kg]   Masse      p.Fn = 1000;  % [N]    Normalkraft      p.Sn =  200;  % [N]    Normalkraft-Schwankung      p.fn =  5;    % [N]    Normalkraft-Schwankungs-Frequenz      p.mu = 0.8;   % [1]    Reibkoeffizient (0-2)                   !!!      p.v  = 5;     % [m/s]  Bandgeschwindigkeit (1-5)            p.ux0 = 0;    % [m]    Anfangsauslenkung      p.uy0 = 0;    % [m]    Anfangsauslenkung      p.vx0 = 0;    % [m/s]  Anfangsgeschwindigkeit      p.vy0 = 0;    % [m/s]  Anfangsgeschwindigkeit         p.tmax = 0.11;      p.dt = 1e-6;      p.kind = 'vx'   end%% Umwandlung der Gleichungen in ein System 1. Ordnung%%    dux/dt = vx%    duy/dt = vy%    dvx/dt = 1/m * [-c1*vx - (kx+k/2)*ux + k/2*uy - mu*ky*uy*sign(1-vx/v)] %    dvy/dt = 1/m * [-c2*vy + k/2*ux - (ky+k/2)*uy - Fn ]%   if (nargin == 1)      if (length(x) != 1)         error('first arg must be scalar for index of parameter set!');      end      cmd = sprintf('p = p%g;',x);      eval(cmd);            p.x0 = [p.ux0; p.uy0; p.vx0; p.vy0];  % initial state      p.f = @hoga;                          % function pointer      kx = p.kx;   % [N/m]  Steifigkeit kx      ky = p.ky;   % [N/m]  Steifigkeit ky      k  = p.k;    % [N/m]  Koppelsteifigkeit k      c1 = p.c1;   % [kg/s] Dämpfungsparameter c1 (1-1.2)      c2 = p.c2;   % [kg/s] Dämpfungsparameter c2 (1-1.2)      m  = p.m;    % [kg]   Masse      mu = p.mu;   % [1]    Reibkoeffizient (0-2)      p.A1 = [      0        0        1      0                  0        0        0      1              [-(kx+k/2) k/2-mu*ky -c1     0 ]/m              [k/2     -(ky+k/2)    0     -c2]/m           ];      p.A2 = [      0        0        1      0                  0        0        0      1              [-(kx+k/2) k/2+mu*ky -c1     0 ]/m              [   k/2   -(ky+k/2)    0    -c2]/m            ];      p.b = [0 0 0 -p.Fn/m]';            f = p;   % return value   else      kx = p.kx;   % [N/m]  Steifigkeit kx      ky = p.ky;   % [N/m]  Steifigkeit ky      k  = p.k;    % [N/m]  Koppelsteifigkeit k      c1 = p.c1;   % [kg/s] Dämpfungsparameter c1 (1-1.2)      c2 = p.c2;   % [kg/s] Dämpfungsparameter c2 (1-1.2)      m  = p.m;    % [kg]   Masse      Fn = p.Fn;   % [N]    Normalkraft      Sn = p.Sn;   % [N]    Normalkraft-Schwankung      fn = p.fn;   % [N]    Normalkraft-Schwankungs-Frequenz      mu = p.mu;   % [1]    Reibkoeffizient (0-2)      v  = p.v;    % [m/s]  Bandgeschwindigkeit (1-5)      Fn = (Fn-Sn/2) + Sn/2*cos(2*pi*fn*t);            f = [             x(3)             x(4)             [-c1*x(3) - (kx+k/2)*x(1) + k/2*x(2) - mu*ky*x(2)*sign(1-x(3)/v)]/m             [-c2*x(4) + k/2*x(1) - (ky+k/2)*x(2)  - Fn]/m          ];   endend
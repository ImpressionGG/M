function fitting(mode)%   %  FITTING   Fitting of two clusters
%%               fitting(1)             % show cluster 1%               fitting(2)             % show cluster 2%               fitting(3)             % show all after fitting%   p = sloc4(1,0.5);         clo = [41 2 3 30 29 20 6];                        % overlap   cl1 = [41 2 3 30 29 20 6 24 27 33 13 18 47 34 1 28 35 25 16 12 43];  % cluster 1   cl2 = [41 2 3 30 29 20 6 26 46 4 10 7 23 37 42 8 32 ...          40 44 9 45 22 5 31 39 38 21 19 17 15 36 48 14 11];  % cluster 2   switch (mode)      case 1         ShowCluster1(p,clo,cl1,cl2);      case 2         ShowCluster2(p,clo,cl1,cl2);      case 3         ShowAll(p,clo,cl1,cl2);   endend
function ShowAll(p,clo,cl1,cl2)   circle(p,clo,'r',0.4,2);   circle(p,cl1,'g',0.3,2);   circle(p,cl2,'b',0.25,2);   splot(p,'r',0);end
function ShowCluster1(p,clo,cl1,cl2)   [m,n] = size(p);   for (j=1:n)      if (all(cl1~=j))         p(:,j) = [NaN;NaN];      end   end   p = 1.0*(rot(pi/2)*p + [12;0]*ones(1,n));   splot(p);   circle(p,clo,'r',0.4,2);   circle(p,cl1,'g',0.3,2);   set(gca,'xlim',[0 13],'ylim',[0 9]);endfunction ShowCluster2(p,clo,cl1,cl2)   [m,n] = size(p);   for (j=1:n)      if (all(cl2~=j))         p(:,j) = [NaN;NaN];      end   end   p = 0.7*(rot(pi/4)*p + [4;-4]*ones(1,n));   splot(p);   circle(p,clo,'r',0.4,2);   circle(p,cl2,'b',0.25,2);   set(gca,'xlim',[0 13],'ylim',[0 9]);end
function aoaprinciple%   % AOAPRINCIPLE%   deg = 180/pi;      phi = 0:pi/50:2*pi;   r1 = 1.4 + cos(phi) - 0.1*((1-cos(3*phi))/2).^4;   r2 = 1.3 + sin(phi) + 0.2*((1-sin(3*phi))/2).^4;   r3 = 1.4 + cos(phi+pi) - 0.1*((1-cos(3*(phi+pi)))/2).^4;      r1 = r1/max(r1);   r2 = r2/max(r2);   r3 = r3/max(r3);      clf;   subplot(121);   plot(r1.*cos(phi),r1.*sin(phi),'r');   hold on;   plot(r2.*cos(phi),r2.*sin(phi),'b');   plot(r3.*cos(phi),r3.*sin(phi),'m');   plot([-1 1],[ 0 0],'k');   plot([ 0 0],[-1 1],'k');   set(gca,'dataaspectratio',[1 1 1]);   set(gca,'xlim',[-1 1]);
   set(gca,'ylim',[-1 1]);   set(gca,'fontsize',20);   h = title('antenna gain');   set(h,'fontsize',10);      subplot(222);   plot(phi*deg,r1,'r');   hold on;   plot(phi*deg,r2,'b');   plot(phi*deg,r3,'m');      r21 = r2-r1;   plot(phi*deg,r21,'g', phi*deg,r21,'go');   r32 = r3-r2;   plot(phi*deg,r32,'c', phi*deg,r32,'co');   set(gca,'xlim',[0 360]);   set(gca,'fontsize',20);   h = title('difference signals');   set(h,'fontsize',10);   h = xlabel('green = blue-red, cyan = magenta-blue');   set(h,'fontsize',10);   subplot(224);   plot(phi*deg,phi*deg,'k-.');   hold on;      theta = atan2(r32,r21) + 3*pi/4;   idx = find(theta<0);   theta(idx) = theta(idx) + 2*pi;   idx = find(theta(1:5)>pi);   theta(idx) = theta(idx) - 2*pi;   plot(phi*deg,theta*deg,'g');   plot(phi*deg,theta*deg,'go');      set(gca,'xlim',[0 360]);   set(gca,'fontsize',20);   h = title('AoA estimation');   set(h,'fontsize',10);   h = xlabel('AoA [deg]');   set(h,'fontsize',10);end
